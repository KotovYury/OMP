# OMP
### Входные параметры:
- Письма, полученные по электронной почте из указанной папки с помощью протокола IMAP со вложениями.
- Таблица исходных данных, с требуемыми параметрами воздушных линий (ВЛ) электропередач энергосистемы.
### Выходные параметры:
Письмо, отправленное по электронной почте с результатом расчета, либо с описанием возникшего исключения.
### Описание работы робота:
Робот выполняет расчет определения места повреждения (ОМП) на ВЛ на основе полученных значений двустороннего замера параметров аварийного режима.
Робот заключен в бесконечный цикл и с интервалом в 10 минут начинает с проверки электронной почты на наличие новых писем. Для дальнейшей работы выполняется проверка наличия в полученном письме двух файлов с данными во вложении. Далее происходит считывание файла с параметрами всех ВЛ энергосистемы из файла, хранящегося на компьютере. С каждыми из двух файлов из письма происходит один и тот же набор действий, в результате которых: будет прочитано наименование подстанции (ПС), на которой был произведен замер параметров аварийного режима, будут прочитаны сами параметры аварийного режима, используемые для расчета, и внесены в специальный файл Excel с уже вписанными расчетными формулами, выполняющий роль калькулятора. По полученным наименованиям ПС из двух файлов, в таблице с данными ВЛ будет найдена нужная строка с нужной ВЛ и ее параметрами, которые так же будут записаны в файл Excel, который на основе всех внесенных данных расчитывает место повреждения на ВЛ. Полученное значение является результатом расчета, будет считано роботом и отправлено по электронной почте. Внесенные в файл Excel данные будут очищены и цикл повторяется. В случае возникновения исключения будет направлено письмо оператору робота с описанием исключния.

Робот разработан на платформе UiPath с применением языка программирования C# для работы с переменными и аргументами.

В папке Data находятся файлы, которые возможно использовать для тестирования. Файлы "test1", "test2" содержат данные, получаемые с ПС. Файл "Данные" на листе "Данные" содержит строку с параметрами ВЛ, подходящими для тестирования, на листе "Расчет" находится таблица с внесенными формулами, расчитывающая финальный результат.
